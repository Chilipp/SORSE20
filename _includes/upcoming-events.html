<div id='calendar'></div>
[Full event calendar]({{ "/programme/calendar/" | relative_url }})
{: .text-right}

<script>

 document.addEventListener('DOMContentLoaded', function() {
   var calendarEl = document.getElementById('calendar');

   {%- assign events = '' | split: '' -%}
   {%- for post in site.events -%}
     {%- if post.time -%}
       {%- assign events = events | push: post -%}
     {%- endif -%}
   {%- endfor -%}

   var events = [
      {% include coc-deadlines.js %},
      {% for post in events %}
      {% include event.js %}{% if forloop.last %}{% else %},{% endif %}
      {% endfor %}
   ];

   events = events.filter(e => new Date(e.start) >= new Date());
   events.sort((e1, e2) => new Date(e1.start) - new Date(e2.start));

   calendar = new FullCalendar.Calendar(calendarEl, {
     headerToolbar: false,
     noEventsContent: "No upcoming events",
     initialView: 'listYear',
     editable: true,
     selectable: true,
     events: events
   });
  calendar.render();
});
</script>
